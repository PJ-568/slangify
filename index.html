<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å£åƒ»è½¬æ¢å™¨</title>
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EğŸ‘„%3C/text%3E%3C/svg%3E"
    />
  </head>
  <body>
    <h1>å£åƒ»è½¬æ¢å™¨</h1>
    <div>
      <textarea
        id="input"
        rows="5"
        cols="50"
        placeholder="è¾“å…¥æ–‡æœ¬..."
      ></textarea>
    </div>
    <div>
      <button onclick="convertToSlang()">è½¬æ¢ä¸ºå£åƒ»</button>
      <button onclick="convertFromSlang()">ä»å£åƒ»è½¬æ¢</button>
    </div>
    <div>
      <textarea id="output" rows="5" cols="50" readonly></textarea>
    </div>
    <a href="https://github.com/PJ-568/slangify">æº</a>

    <script>
      function convertToSlang() {
        const input = document.getElementById("input").value;
        let output = input;

        // åœ¨æ ‡ç‚¹ç¬¦å·å‰æ’å…¥"å–µ"
        output = output.replace(
          /([ï¼Œã€‚ï¼ï¼Ÿï¼›ï¼šâ€œ"â€â€˜'â€™ï¼ˆï¼‰ã€ã€‘ã€Šã€‹ã€])/g,
          "å–µ$1"
        );

        // åœ¨æ¯å¥è¯ç»“å°¾é™„åŠ éšæœºæ•°é‡çš„ w æˆ–å•ä¸ª owoï¼Œä¿æŒåŸæœ‰æ ‡ç‚¹ç¬¦å·
        const sentencesWithPunctuation = output.split(/([ã€‚ï¼ï¼Ÿ])/);
        output = "";
        for (let i = 0; i < sentencesWithPunctuation.length - 1; i += 2) {
          const sentence = sentencesWithPunctuation[i];
          const punctuation = sentencesWithPunctuation[i + 1];

          if (sentence.trim() && punctuation) {
            const suffix =
              Math.random() > 0.75
                ? "owo"
                : "w".repeat(Math.floor(Math.random() * 5) + 1);
            output += sentence + punctuation + suffix;
          }
        }
        if (
          sentencesWithPunctuation[sentencesWithPunctuation.length - 1].trim()
        ) {
          output +=
            sentencesWithPunctuation[sentencesWithPunctuation.length - 1];
        }

        // åº”ç”¨æœ€åçš„æ ¼å¼
        output = `ï¼ˆ${output}å‘€ï¼‰`;

        document.getElementById("output").value = output;
      }

      function convertFromSlang() {
        const input = document.getElementById("input").value;
        let output = input;

        // ç§»é™¤æœ€åçš„æ ¼å¼
        if (output.startsWith("ï¼ˆ") && output.endsWith("å‘€ï¼‰")) {
          output = output.substring(1, output.length - 2);
        }

        // ç§»é™¤å¥å­ç»“å°¾çš„ w æˆ– owoï¼Œæ”¯æŒæ‰€æœ‰æ ‡ç‚¹ç¬¦å·
        output = output.replace(/([ã€‚ï¼ï¼Ÿ])(owo|w+)/g, "$1");

        // ç§»é™¤æ ‡ç‚¹ç¬¦å·å‰çš„"å–µ"
        output = output.replace(
          /å–µ([ï¼Œã€‚ï¼ï¼Ÿï¼›ï¼šâ€œ"â€â€˜'â€™ï¼ˆï¼‰ã€ã€‘ã€Šã€‹ã€])/g,
          "$1"
        );

        document.getElementById("output").value = output;
      }
    </script>
  </body>
</html>
